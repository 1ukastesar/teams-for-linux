name: Remove awaiting feedback label on comment

# When a non-bot user comments on an issue that has the "awaiting user feedback"
# label, automatically remove the label so maintainers know the user has responded.

on:
  issue_comment:
    types: [created]

# Restrict default permissions â€” each job declares only what it needs
permissions: {}

jobs:
  remove-label:
    runs-on: ubuntu-latest
    if: >-
      !github.event.issue.pull_request
      && !endsWith(github.event.comment.user.login, '[bot]')
      && contains(github.event.issue.labels.*.name, 'awaiting user feedback')
    permissions:
      issues: write

    steps:
      - name: Remove awaiting user feedback label
        uses: actions/github-script@ed597411d8f924073f98dfc5c65a23a2325f34cd # v8.0.0
        with:
          script: |
            await github.rest.issues.removeLabel({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.issue.number,
              name: 'awaiting user feedback',
            });
